package iot.unipi.cloudapp;

import org.eclipse.californium.core.CoapResource;
import org.eclipse.californium.core.coap.CoAP.ResponseCode;
import org.eclipse.californium.core.coap.Response;
import org.eclipse.californium.core.server.resources.CoapExchange;
import org.json.simple.JSONObject;
import org.json.simple.parser.JSONParser;

public class RegistrationResource extends CoapResource {

	public RegistrationResource(String name) {
		super(name);
	}

	public void handlePOST(CoapExchange exchange) {
		
		byte[] request = exchange.getRequestPayload();
		
		String content = new String(request);
		JSONObject contentJson = (JSONObject) (new JSONParser()).parse(content);
		System.out.println(contentJson);
				
		Integer value = Integer.parseInt(s);
		
		Double resp = Math.sqrt(value);
		
		s=Double.toString(resp);
		
		Response response = new Response(ResponseCode.CONTENT);
		
		response.setPayload(s);
				
		exchange.respond(response);
 	}
}
